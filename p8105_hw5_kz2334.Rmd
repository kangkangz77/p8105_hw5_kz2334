---
title: "p8105_hw5_kz2334"
author: "Kangkang Zhang"
date: "11/7/2018"
output: github_document
---

##Problem 1

Load required packages.

```{r library, message = FALSE}
#load packages
library(tidyverse)
library(viridis)
```
<br>
Import file names to create a dataframe.

```{r import}
file_name = tibble(
  id = list.files("./data/")
)
```
<br>
Read in data for each subject.

```{r import data, message = FALSE}
study_data = file_name %>% 
  mutate(infor = purrr::map(str_c("./data/", id), read_csv)) 

study_data


```
<br>
Tidy the result and manipulate file names to include control arm and subject ID.

```{r tidy}
study_data = study_data %>%
  mutate( id = str_replace(id, ".csv", "")) %>% 
  separate(id, into = c("arm", "id"), sep = "_") %>%
  unnest() %>% 
  gather(week, value = value, week_1:week_8) %>% 
  mutate(week = as.numeric(str_replace(week, "week_", "")))

study_data
```
<br>
Make a spaghetti plot showing observations on each subject over time.
```{r spaghetti plot, fig.align = 'center'}
study_data %>%  
  ggplot(aes(x = week, y = value, color = id, linetype = arm)) + 
  geom_line() +
  labs(
    title = "Spaghetti plot",
    x = "Week",
    y = "Observation"
  ) +
  theme_bw() +
  scale_x_discrete(breaks=seq(0, 8, 1)) +
  scale_linetype_discrete(label = c("Control", "Experimental")) +
  scale_color_viridis(discrete = TRUE)
```

Globally, experimental group has larger observation values than control group. In experimental group, observations increased as time went by. In control group, observations fluctuated within an interval as time went by.

##Problem 2